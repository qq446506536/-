<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.css">
    <script src="/static/juery/jQuery%20v3.3.1.js"></script>
    <script src="/static/juery/jquery.cookie.js"></script>
    <script src="/static/bootstrap/js/bootstrap.js"></script>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        .bac {
            position: absolute;
            height: 100%;
            width: 100%;
            background-size: cover;
            opacity: 1;

        }
    </style>
    <title>首页</title>
</head>
<body>
<div class="bac" style="background-image: url('/static/img/641eb21a3a026857e6c8b641d1e55588.jpg') ">

</div>
<div class="wrap">

</div>
<div class="container" style="">
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <form class="form-horizontal has-success col-md-offset-3" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <label for="inputEmail3" class="col-sm-2 control-label" style="color:#9e9e9e ">账号</label>
            <div class="col-sm-5">
                <input type="text" class="form-control" id="inputusm" placeholder="请输入账号" name="usm">
            </div>
        </div>
        <div class="form-group">
            <label for="inputPassword3" class="col-sm-2 control-label" style="color: #9e9e9e">密码</label>
            <div class="col-sm-5">
                <input type="password" class="form-control" id="inputPassword3" placeholder="请输入密码" name="pwd">
            </div>
        </div>

        <div class="form-group">
            <label for="inputPassword3" class="col-sm-2 control-label" style="color: #9e9e9e">验证码</label>
            <div class="col-sm-5">
                <input type="text" class="form-control" id="inputcode" placeholder="请输入验证码" name="code">
                <span class="pull-right" style="margin-top: -32px;"><img onclick="changeImg(this);" src="/code/" alt="" title="点击更换"></span>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="button" class="btn btn-default" id="login" >登录</button>
                <a href="{% url 'register' %}" class="btn  btn-default " role="button">注册</a>
                {#                <button type="submit" class="btn btn-default">注册</button>#}
            </div>
        </div>
    </form>
</div>
</body>
</html>
<script>
    function changeImg(ths) {
        ths.src = ths.src + '?';
    }
    function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", $.cookie('csrftoken'));
            }
        }
    });




    $('#login').click(function () {
        $.ajax(
            {
                url:'/login/',
                type:'post',
                {#headers:{ "X-CSRFToken":$.cookie('csrftoken') },#}
                data:{
                    usm:$('#inputusm').val(),
                    pwd:$('#inputPassword3').val(),
                    code:$('#inputcode').val()
                },
                success:function (data) {
                window.location=data.url


                }
            }
        )


    })
</script>